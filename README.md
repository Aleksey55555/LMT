# Logistic Model Tree (LMT): Experiments

## ðŸ“Œ ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ
Ð­Ñ‚Ð¾Ñ‚ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ ÑÐºÑÐ¿ÐµÑ€Ð¸Ð¼ÐµÐ½Ñ‚Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¸ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ðµ **Logistic Model Tree (LMT)** â€” Ð³Ð¸Ð±Ñ€Ð¸Ð´Ð½Ð¾Ð¹ Ð¼Ð¾Ð´ÐµÐ»Ð¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð¾Ð±ÑŠÐµÐ´Ð¸Ð½ÑÐµÑ‚:
- ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Ð´ÐµÑ€ÐµÐ²Ð° Ñ€ÐµÑˆÐµÐ½Ð¸Ð¹ (Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¿Ð¾ Ð¿Ñ€Ð¸Ð·Ð½Ð°ÐºÐ°Ð¼);
- Ð»Ð¾Ð³Ð¸ÑÑ‚Ð¸Ñ‡ÐµÑÐºÑƒÑŽ Ñ€ÐµÐ³Ñ€ÐµÑÑÐ¸ÑŽ Ð² Ð»Ð¸ÑÑ‚ÑŒÑÑ… (Ð´Ð»Ñ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ).

Ð ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ LMT Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð°Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ `scikit-learn` API, Ñ‚Ð°ÐºÐ¶Ðµ Ð¿Ñ€Ð¸Ð²ÐµÐ´ÐµÐ½Ð¾ ÐµÑ‘ ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ñ ÐºÐ»Ð°ÑÑÐ¸Ñ‡ÐµÑÐºÐ¸Ð¼Ð¸ Ð¼Ð¾Ð´ÐµÐ»ÑÐ¼Ð¸:  
- Logistic Regression  
- Random Forest  
- XGBoost  

Ð¢Ð°ÐºÐ¶Ðµ Ð¿Ñ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ Ð°Ð½ÑÐ°Ð¼Ð±Ð»Ð¸:
- **LMT-Bagging** (Ñ‡ÐµÑ€ÐµÐ· `BaggingClassifier`)  
- **LMT-Boosting**
- **Gradient Boosting (LogitBoost-style) Ñ LMT-Ð»Ð¸ÑÑ‚Ð°Ð¼Ð¸**

## ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ð¸Ð´ÐµÐ¸
- **Logistic Model Tree (LMT)** â€” Ð´ÐµÑ€ÐµÐ²Ð¾ Ñ€ÐµÑˆÐµÐ½Ð¸Ð¹, Ð² Ð»Ð¸ÑÑ‚ÑŒÑÑ… ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð³Ð¾ Ð²Ð¼ÐµÑÑ‚Ð¾ ÐºÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ñ‹ Ð¾Ð±ÑƒÑ‡Ð°ÐµÑ‚ÑÑ Ð»Ð¾Ð³Ð¸ÑÑ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ñ€ÐµÐ³Ñ€ÐµÑÑÐ¸Ñ.
- LMT c Ð°Ð½ÑÐ°Ð¼Ð±Ð»ÐµÐ²Ñ‹Ð¼Ð¸ Ð¼ÐµÑ‚Ð¾Ð´Ð°Ð¼Ð¸:
  - **LMT + Bagging (RF-style)** â€” Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ LMT Ð¾Ð±ÑƒÑ‡Ð°ÑŽÑ‚ÑÑ Ð½Ð° Ð±ÑƒÑ‚ÑÑ‚Ñ€Ð°Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… ÑÑÐ¼Ð¿Ð»Ð°Ñ….
  - **LMT + Boosting (AdaBoost-style)** â€” Ð¿Ð¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ ÑƒÑÐ¸Ð»ÐµÐ½Ð¸Ðµ Ð¾ÑˆÐ¸Ð±Ð¾Ðº Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ LMT.
  - **LMT-GB (Gradient Boosting)** â€” Ð´ÐµÑ€ÐµÐ²ÑŒÑ Ð´ÐµÐ»ÑÑ‚ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²Ð¾ Ð¿Ñ€Ð¸Ð·Ð½Ð°ÐºÐ¾Ð², Ð² Ð»Ð¸ÑÑ‚ÑŒÑÑ… Ð¾Ð±ÑƒÑ‡Ð°ÑŽÑ‚ÑÑ Ð»Ð¾Ð³Ð¸ÑÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ€ÐµÐ³Ñ€ÐµÑÑÐ¸Ð¸ (Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¾Ð¹ `reuse_ratio` Ð´Ð»Ñ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð½Ð¾Ð²Ñ‹Ñ… Ð¿Ñ€Ð¸Ð·Ð½Ð°ÐºÐ¾Ð²).
- Ð ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð° Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ñ€ÐµÐ³ÑƒÐ»ÑÑ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸ (`L1`, `L2`, `elasticnet`) Ð² Ð»Ð¾Ð³Ð¸ÑÑ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ Ñ€ÐµÐ³Ñ€ÐµÑÑÐ¸Ð¸ Ð½Ð° Ð»Ð¸ÑÑ‚ÑŒÑÑ….

## Ð ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ
Ð’ Ð½Ð¾ÑƒÑ‚Ð±ÑƒÐºÐµ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ñ‹:
- `LogisticModelTreePenalized` â€” Ð±Ð°Ð·Ð¾Ð²Ñ‹Ð¹ LMT Ñ Ñ€ÐµÐ³ÑƒÐ»ÑÑ€Ð¸Ð·Ð°Ñ†Ð¸ÐµÐ¹.
- `LMTGradientBoostingBinary` Ð¸ `OneVsRestLMTGB` â€” Ð³Ñ€Ð°Ð´Ð¸ÐµÐ½Ñ‚Ð½Ñ‹Ð¹ Ð±ÑƒÑÑ‚Ð¸Ð½Ð³ Ñ Ð»Ð¾Ð³Ð¸ÑÑ‚Ð¸ÐºÐ¾Ð¹ Ð² Ð»Ð¸ÑÑ‚ÑŒÑÑ… (OVR Ð´Ð»Ñ Ð¼ÑƒÐ»ÑŒÑ‚Ð¸ÐºÐ»Ð°ÑÑÐ°).
- `TreeWithLRLeaves` â€” Ð´ÐµÑ€ÐµÐ²Ð¾, Ð² Ð»Ð¸ÑÑ‚ÑŒÑÑ… ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð³Ð¾ Ð¾Ð±ÑƒÑ‡Ð°ÑŽÑ‚ÑÑ Ð»Ð¾Ð³Ð¸ÑÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ€ÐµÐ³Ñ€ÐµÑÑÐ¸Ð¸, Ñ ÐºÐ²Ð¾Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ Ð¿Ñ€Ð¸Ð·Ð½Ð°ÐºÐ¾Ð² (`reuse_ratio`, `topk_frac`).
- ÐÐ½ÑÐ°Ð¼Ð±Ð»Ð¸:
  - `make_rf_style_with_lr_leaves` â€” Bagging Ð´Ð»Ñ LMT.
  - `make_boosting_with_lr_leaves` â€” Boosting Ð´Ð»Ñ LMT.

## Ð”Ð°Ñ‚Ð°ÑÐµÑ‚Ñ‹
Ð”Ð°Ñ‚Ð°Ñ‚ÑÐµÑ‚Ñ‹, ÑƒÑ‡Ð°ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ Ð² ÑÐºÑÐ¿ÐµÑ€Ð¸Ð¼ÐµÐ½Ñ‚Ðµ:
- `breast_cancer` â€” Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ° Ñ€Ð°ÐºÐ° Ð³Ñ€ÑƒÐ´Ð¸.
- `wine` â€” ÐºÐ»Ð°ÑÑÐ¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ Ð²Ð¸Ð½.
- `digits` â€” Ñ€ÑƒÐºÐ¾Ð¿Ð¸ÑÐ½Ñ‹Ðµ Ñ†Ð¸Ñ„Ñ€Ñ‹.
- `adult income` â€” Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ðµ ÑƒÑ€Ð¾Ð²Ð½Ñ Ð´Ð¾Ñ…Ð¾Ð´Ð° (>50k Ð¸Ð»Ð¸ <=50k).
- `synthetic piecewise_logit` â€” ÑÐ¸Ð½Ñ‚ÐµÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð´Ð°Ñ‚Ð°ÑÐµÑ‚ Ñ ÐºÑƒÑÐ¾Ñ‡Ð½Ð¾-Ð»Ð¾Ð³Ð¸ÑÑ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¾Ð¹.

## Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ (Ð¿Ñ€Ð¸Ð¼ÐµÑ€)
### Wine dataset
| Model                  | Accuracy | Precision | Recall | F1    |
|-------------------------|----------|-----------|--------|-------|
| XGBoost                | 1.000    | 1.000     | 1.000  | 1.000 |
| Random Forest           | 1.000    | 1.000     | 1.000  | 1.000 |
| Logistic Regression     | 0.981    | 0.982     | 0.981  | 0.981 |
| SVM (RBF)               | 0.981    | 0.982     | 0.981  | 0.981 |
| **LMT-GB (OVR, tuned)** | 0.944    | 0.945     | 0.944  | 0.944 |

### Adult dataset
| Model                  | Accuracy | Precision | Recall | F1    |
|-------------------------|----------|-----------|--------|-------|
| XGBoost                | 0.875    | 0.871     | 0.875  | 0.871 |
| **LMT-GB (Optuna, Adult)** | 0.876 | 0.872     | 0.876  | 0.872 |
| Random Forest           | 0.857    | 0.851     | 0.857  | 0.852 |
| Logistic Regression     | 0.856    | 0.849     | 0.856  | 0.850 |

ÐÐ° **Adult Income** LMT-GB Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ **ÑÐ¾Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ð¼Ñ‹Ð¹ Ñ XGBoost Ð¸ Ð²Ñ‹ÑˆÐµ RF**, Ñ‡Ñ‚Ð¾ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´Ð°ÐµÑ‚ ÐµÐ³Ð¾ Ð¿Ñ€Ð°ÐºÑ‚Ð¸Ñ‡ÐµÑÐºÑƒÑŽ Ñ†ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ.

